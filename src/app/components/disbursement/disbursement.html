<!-- ================= PAGE LAYOUT ================= -->
<div class="min-h-screen bg-gray-50 overflow-x-hidden">
  <div class="flex min-w-0">

    <!-- ================= SIDEBAR ================= -->
    <aside class="hidden lg:block fixed inset-y-0 left-0 w-[280px] bg-primary z-40">
      <app-sidebar></app-sidebar>
    </aside>

    <!-- ================= MAIN ================= -->
    <div class="flex-1 lg:ml-[280px] flex flex-col min-w-0">

      <!-- ================= HEADER ================= -->
      <header class="z-50 bg-primary shadow-sm">
        <app-header></app-header>
      </header>

      <!-- ================= CONTENT ================= -->
      <main class="flex-1 p-4 sm:p-6 overflow-y-auto overflow-x-hidden">

        <section class="bg-[#FAFAFA] rounded-[20px] p-4 sm:p-6">

          <!-- ================= PAGE HEADER ================= -->
          <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-6">
            <h1 class="text-lg sm:text-xl font-semibold text-[#444A6D]">
              Disbursement
            </h1>

            <button
              class="bg-secondary text-white text-sm px-4 py-2 rounded-lg w-full sm:w-auto"
              (click)="addNewFacility()">
              + Add New
            </button>
          </div>

          <!-- ================= FILTERS ================= -->
          <div class="bg-white rounded-[16px] p-4 mb-4 shadow-sm">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 max-w-md">
              <div>
                <label class="block text-xs text-[#444A6D] mb-1">Borrower</label>
                <select class="w-full border rounded-lg px-3 py-2 text-sm">
                  <option>Select</option>
                </select>
              </div>

              <div>
                <label class="block text-xs text-[#444A6D] mb-1">Facility</label>
                <select class="w-full border rounded-lg px-3 py-2 text-sm">
                  <option>Select</option>
                </select>
              </div>
            </div>
          </div>

          <!-- ================= TABLE (SCROLL ONLY HERE) ================= -->
          <div class="relative -mx-4 sm:-mx-6">
            <div class="overflow-x-auto px-4 sm:px-6">
              <table class="min-w-[900px] w-full border-separate border-spacing-y-3">

                <thead class="text-xs text-[#8A8FB9]">
                  <tr>
                    <th class="text-left px-6 py-3">Facility Name</th>
                    <th class="text-left px-4 py-3">Phase</th>
                    <th class="text-left px-4 py-3">Amount</th>
                    <th class="text-left px-4 py-3">Date</th>
                    <th class="text-left px-4 py-3">Status</th>
                    <th class="text-center px-4 py-3">Actions</th>
                  </tr>
                </thead>

                <tbody>
                  <tr *ngFor="let row of paginatedFacilities"
                      class="bg-white shadow-sm rounded-[18px] text-sm text-[#0E134F]">

                    <td class="px-6 py-4 font-medium rounded-l-[18px] break-words">
                      {{ row.facilityName }}
                    </td>

                    <td class="px-4 py-4">{{ row.phase }}</td>
                    <td class="px-4 py-4">{{ row.amount | number }}</td>
                    <td class="px-4 py-4">{{ row.date | date:'dd/MM/yyyy' }}</td>

                    <td class="px-4 py-4">
                      <span
                        class="px-4 py-1 text-xs font-medium rounded-full"
                        [ngClass]="{
                          'bg-blue-50 text-[#5B93FF]': row.status === 'Active',
                          'bg-orange-50 text-orange-500': row.status === 'Draft'
                        }">
                        {{ row.status }}
                      </span>
                    </td>

                    <td class="px-4 py-4 rounded-r-[18px]">
                      <div class="flex justify-center gap-3">
                        <button class="h-9 w-9 rounded-full bg-blue-50 flex items-center justify-center"
                          (click)="openEditFacility(row)">
                          <img src="/public/1.png" class="h-4 w-4" />
                        </button>

                        <button class="h-9 w-9 rounded-full bg-green-50 flex items-center justify-center"
                          (click)="openRepaymentList()">
                          <img src="/public/2.png" class="h-4 w-4" />
                        </button>

                        <button class="h-9 w-9 rounded-full bg-purple-50 flex items-center justify-center"
                          (click)="addNewRepayment()">
                          <img src="/public/3.png" class="h-4 w-4" />
                        </button>
                      </div>
                    </td>

                  </tr>
                </tbody>

              </table>
            </div>
          </div>

          <!-- ================= PAGINATION ================= -->
          <div class="flex items-center justify-between mt-4 text-xs text-[#8A8FB9]">
            <span>
              Showing {{ startRecord }}–{{ endRecord }} of {{ totalRecords }}
            </span>

            <div class="flex gap-2">
              <button class="h-7 w-7 border rounded-md"
                (click)="prevPage()" [disabled]="currentPage === 1">‹</button>

              <button class="h-7 w-7 border rounded-md"
                (click)="nextPage()" [disabled]="endRecord === totalRecords">›</button>
            </div>
          </div>

        </section>
      </main>
    </div>
  </div>
</div>
